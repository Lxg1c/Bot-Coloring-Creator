# üé® Coloring Book Bot

Telegram-–±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –æ–ø–∏—Å–∞–Ω–∏—é –∏–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–∞—Å–∫—Ä–∞—Å–∫—É —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ **Stable Diffusion**.
–ü–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∫ –¥–ª—è –¥–µ—Ç–µ–π, —Ç–∞–∫ –∏ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö ‚Äî —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä–∞—Å–∫—Ä–∞—Å–∫–∏ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫!

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –±–æ—Ç ‚Äî –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å –º–æ–¥–µ–ª—å—é –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/Lxg1c/botColoringCreator.git
cd coloring-book-bot
```

---

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ)

> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± ‚Äî —á–µ—Ä–µ–∑ Poetry

–°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

```bash
python -m venv .venv
source .venv/bin/activate  # –∏–ª–∏ .\venv\Scripts\activate –¥–ª—è Windows
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Poetry:

```bash
pip install poetry
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
poetry install
```

---

### 3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
```

> üîê **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ `.env` –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ!**

---

### 4. üöÄ –ó–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é Docker Compose

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞
```bash
coloring-book-bot/
‚îú‚îÄ‚îÄ apiColoringCreator/        # Backend-—Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile             # Dockerfile –¥–ª—è backend
‚îÇ
‚îú‚îÄ‚îÄ botColoringCreator/        # Telegram-–±–æ—Ç –Ω–∞ aiogram
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile             # Dockerfile –¥–ª—è –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –±–æ—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ .env                       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è kafka –∏ zookeeper
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml         # –û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Å–µ—Ç–µ–π Docker
```
#### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [Docker](https://docs.docker.com/get-docker/) –∏ [Docker Compose](https://docs.docker.com/compose/install/).

#### 2. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ `.env`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é kafka –∏ zookeeper:

```env
# Kafka
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka-task:9092
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT
KAFKA_LISTENERS=PLAINTEXT://0.0.0.0:9092
KAFKA_MESSAGE_MAX_BYTES=36700160
KAFKA_REPLICA_FETCH_MAX_BYTES=36700160
KAFKA_MAX_REQUEST_SIZE=36700160
KAFKA_DEFAULT_TOPIC_MAX_MESSAGE_BYTES=36700160

# Zookeeper
ZOOKEEPER_CLIENT_PORT=2181

# Kafdrop
KAFKA_BROKERCONNECT=kafka-task:9092
```

#### 3. –¢–∞–∫ –∂–µ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ docker-compose.yml, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–æ–≤

```docker-compose.yml
services:
  zookeeper:
    image: wurstmeister/zookeeper:latest
    container_name: zookeeper
    ports:
      - "2181:2181"
    env_file:
      - .env
    networks:
      - coloring-network

  kafka:
    image: wurstmeister/kafka:latest
    container_name: kafka
    ports:
      - "9092:9092"
    env_file:
      - .env
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT
      KAFKA_LISTENERS: PLAINTEXT://0.0.0.0:9092
      KAFKA_MESSAGE_MAX_BYTES: 36700160
      KAFKA_REPLICA_FETCH_MAX_BYTES: 36700160
      KAFKA_MAX_REQUEST_SIZE: 36700160
      KAFKA_DEFAULT_TOPIC_MAX_MESSAGE_BYTES: 36700160
    healthcheck:
      test: ["CMD-SHELL", "kafka-broker-api-versions.sh --bootstrap-server localhost:9092"]
      interval: 30s
      timeout: 10s
      retries: 5
    depends_on:
      - zookeeper
    networks:
      - coloring-network

  kafdrop:
    image: obsidiandynamics/kafdrop
    container_name: kafdrop
    ports:
      - "9000:9000"
    environment:
      KAFKA_BROKERCONNECT: kafka:9092
    depends_on:
      - kafka
    networks:
      - coloring-network

  bot:
    build:
      context: ./botColoringCreator
      dockerfile: Dockerfile
    container_name: tg-bot
    env_file:
      - .env
    depends_on:
      - kafka
    networks:
      - coloring-network

  backend:
    build:
      context: ./apiColoringCreator
      dockerfile: Dockerfile
    container_name: coloring-backend
    env_file:
      - .env
    depends_on:
      - kafka
    networks:
      - coloring-network


networks:
  coloring-network:
    name: coloring-network
```

#### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker-compose up -d --build
```

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∑–∞–ø—É—â–µ–Ω—ã:

* üß† `backend` ‚Äî —Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
* ü§ñ `bot` ‚Äî Telegram-–±–æ—Ç
* üêò `kafka` –∏ `zookeeper` ‚Äî –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
* üìä `kafdrop` ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ Kafka (–ø–æ –∞–¥—Ä–µ—Å—É [http://localhost:9000](http://localhost:9000))

> ‚ö†Ô∏è –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç `9092` (Kafka) –∏ `9000` (Kafdrop) –Ω–µ –∑–∞–Ω—è—Ç—ã –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

---

## üß† –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **–æ–ø–∏—Å–∞–Ω–∏–µ** –∏–ª–∏ **–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**.
2. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å.
3. –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:

   * –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Kafka.
   * Backend-—Å–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–∞—Å–∫—Ä–∞—Å–∫—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ Kafka.
   * –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é —Ä–∞—Å–∫—Ä–∞—Å–∫—É.

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* ü§ñ [`aiogram 3`](https://docs.aiogram.dev)
* üßµ Kafka ‚Äî –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ backend-—Å–µ—Ä–≤–∏—Å–æ–º
* üê≥ Docker + Docker Compose ‚Äî –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
* üì¶ Poetry ‚Äî –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º

---
